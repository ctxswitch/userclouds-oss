package tenantdb

import "userclouds.com/infra/migrate"

// UsedColumns is a list of columns by table used by the orm in this build
// this is used by the db connection schema validator, and "created" at load time
// by a series of _generated.go init() functions to allow parallel data generation
// by genorm during `make codegen`
var UsedColumns = map[string][]string{}

// BaselineSchemaVersion is the version used for SchemaBaseline
var BaselineSchemaVersion = 280

// SchemaBaseline is the baseline tenantdb schema to use for migration tests and schema generation
var SchemaBaseline = migrate.Schema{
	Migrations:       Migrations[:BaselineSchemaVersion+1],
	CreateStatements: schema280,
	Columns:          UsedColumns,
	PostgresOnlyExtensions: []string{
		// See: tools/generate/genschemas/main.go getCreateIndexSQL
		"btree_gin",
		"pg_trgm",
	},
}

var schema280 = []string{
	`CREATE TABLE public.access_policies (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	version INT8 NOT NULL,
	function VARCHAR NOT NULL DEFAULT '',
	parameters VARCHAR NULL DEFAULT '',
	name VARCHAR NOT NULL,
	description VARCHAR NOT NULL,
	policy_type INT8 NOT NULL,
	tag_ids UUID[] NULL,
	component_policy_ids UUID[] NULL,
	component_ids UUID[] NULL,
	component_parameters VARCHAR[] NULL,
	component_types INT4[] NULL,
	is_system BOOL NOT NULL DEFAULT false,
	is_autogenerated BOOL NOT NULL DEFAULT false,
	metadata JSONB NOT NULL DEFAULT '{}',
	thresholds JSONB NOT NULL DEFAULT '{}',
	CONSTRAINT access_policies_pkey PRIMARY KEY (deleted, id, version),
	UNIQUE (name, version, deleted)
)`,
	`CREATE TABLE public.access_policy_templates (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	name VARCHAR NOT NULL DEFAULT '',
	description VARCHAR NOT NULL DEFAULT '',
	function VARCHAR NOT NULL,
	version INT8 NOT NULL,
	is_system BOOL NOT NULL DEFAULT false,
	CONSTRAINT access_policy_templates_pkey PRIMARY KEY (deleted, id, version),
	UNIQUE (deleted, function, version),
	UNIQUE (deleted, name, version)
)`,
	`CREATE TABLE public.accessors (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	name VARCHAR NOT NULL,
	description VARCHAR NOT NULL,
	version INT8 NOT NULL,
	access_policy_id UUID NOT NULL,
	selector_config JSONB NOT NULL DEFAULT '{}',
	column_ids UUID[] NOT NULL DEFAULT ARRAY[]::uuid[],
	transformer_ids UUID[] NOT NULL DEFAULT ARRAY[]::uuid[],
	token_access_policy_id UUID NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000',
	purpose_ids UUID[] NOT NULL DEFAULT ARRAY[]::uuid[],
	is_system BOOL NOT NULL DEFAULT false,
	data_life_cycle_state INT8 NOT NULL DEFAULT 0,
	is_audit_logged BOOL NOT NULL DEFAULT false,
	is_autogenerated BOOL NOT NULL DEFAULT false,
	are_column_access_policies_overridden BOOL NOT NULL DEFAULT false,
	token_access_policy_ids UUID[] NOT NULL DEFAULT ARRAY[]::uuid[],
	CONSTRAINT accessors_pkey PRIMARY KEY (deleted, id, version),
	UNIQUE (name, version, deleted)
)`,
	`CREATE TABLE public.acme_certificates (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	status VARCHAR NOT NULL,
	order_id UUID NOT NULL,
	private_key VARCHAR NOT NULL,
	certificate VARCHAR NOT NULL,
	certificate_chain VARCHAR NOT NULL,
	not_after TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	CONSTRAINT acme_certificates_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.acme_orders (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	status VARCHAR NOT NULL,
	url VARCHAR NOT NULL,
	host VARCHAR NOT NULL,
	token VARCHAR NOT NULL,
	challenge_url VARCHAR NOT NULL,
	tenant_url_id UUID NOT NULL,
	CONSTRAINT acme_orders_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.auditlog (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	actor_id VARCHAR NOT NULL,
	type VARCHAR NULL,
	payload JSONB NOT NULL,
	CONSTRAINT auditlog_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.authns_password (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	user_id UUID NOT NULL,
	username VARCHAR NOT NULL,
	password VARCHAR NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	CONSTRAINT authns_password_pkey PRIMARY KEY (deleted, id),
	UNIQUE (username, deleted)
)`,
	`CREATE INDEX authns_password_user_id_idx ON authns_password (user_id)`,
	`CREATE TABLE public.authns_social (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	user_id UUID NOT NULL,
	type INT8 NOT NULL,
	oidc_sub VARCHAR NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	oidc_issuer_url VARCHAR NOT NULL DEFAULT '',
	CONSTRAINT authns_social_pkey PRIMARY KEY (deleted, id),
	UNIQUE (type, oidc_issuer_url, oidc_sub, deleted)
)`,
	`CREATE INDEX authns_social_user_id_idx ON authns_social (user_id)`,
	`CREATE TABLE public.column_value_retention_durations (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	_version INT8 NOT NULL DEFAULT 0,
	column_id UUID NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000',
	purpose_id UUID NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000',
	duration_type INT8 NOT NULL,
	duration_unit INT8 NOT NULL,
	duration INT8 NOT NULL,
	CONSTRAINT column_value_retention_durations_pkey PRIMARY KEY (deleted, id),
	UNIQUE (deleted, duration_type, purpose_id, column_id)
)`,
	`CREATE TABLE public.columns (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	name VARCHAR NOT NULL,
	type INT8 NOT NULL,
	default_value VARCHAR NOT NULL,
	attributes JSONB NOT NULL DEFAULT '{}',
	index_type INT8 NOT NULL DEFAULT 0,
	is_array BOOL NOT NULL DEFAULT false,
	data_type_id UUID NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000',
	tbl VARCHAR NOT NULL DEFAULT 'users',
	sqlshim_database_id UUID NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000',
	default_transformer_id UUID NOT NULL DEFAULT 'c0b5b2a1-0b1f-4b9f-8b1a-1b1f4b9f8b1a',
	default_token_access_policy_id UUID NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000',
	access_policy_id UUID NOT NULL DEFAULT '3f380e42-0b21-4570-a312-91e1b80386fa',
	CONSTRAINT columns_pkey PRIMARY KEY (deleted, id),
	UNIQUE (deleted, tbl, name)
)`,
	`CREATE TABLE public.custom_pages (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	app_id UUID NOT NULL,
	page_name VARCHAR NOT NULL,
	page_source VARCHAR NOT NULL,
	CONSTRAINT custom_pages_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.data_source_elements (
	id UUID NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL DEFAULT now(),
	data_source_id UUID NOT NULL,
	path VARCHAR NOT NULL,
	type VARCHAR NOT NULL,
	metadata JSONB NOT NULL,
	CONSTRAINT data_source_elements_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.data_sources (
	id UUID NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL DEFAULT now(),
	type VARCHAR NOT NULL,
	name VARCHAR NOT NULL,
	config JSONB NOT NULL,
	metadata JSONB NOT NULL,
	CONSTRAINT data_sources_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.data_types (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	name VARCHAR NOT NULL,
	description VARCHAR NOT NULL,
	concrete_data_type_id UUID NOT NULL,
	composite_attributes JSONB NOT NULL DEFAULT '{}',
	CONSTRAINT data_types_pk PRIMARY KEY (deleted, id),
	UNIQUE (deleted, name)
)`,
	`CREATE TABLE public.delegation_invites (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	client_id VARCHAR NOT NULL,
	invited_to_account_id VARCHAR NOT NULL,
	CONSTRAINT delegation_invites_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.delegation_states (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	authenticated_user_id VARCHAR NOT NULL,
	CONSTRAINT delegation_states_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.edge_types (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	type_name VARCHAR NOT NULL,
	source_object_type_id UUID NOT NULL,
	target_object_type_id UUID NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	attributes JSONB NOT NULL DEFAULT '[]',
	organization_id UUID NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000',
	CONSTRAINT edge_types_pkey PRIMARY KEY (deleted, id),
	UNIQUE (type_name, deleted)
)`,
	`CREATE TABLE public.edges (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	edge_type_id UUID NOT NULL,
	source_object_id UUID NOT NULL,
	target_object_id UUID NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	CONSTRAINT edges_pkey PRIMARY KEY (deleted, id),
	UNIQUE (source_object_id, target_object_id, edge_type_id, deleted)
)`,
	`CREATE INDEX edges_target_object_id_idx ON edges (target_object_id)`,
	`CREATE INDEX edges_updated_time ON edges (updated) INCLUDE (created, edge_type_id, source_object_id, target_object_id)`,
	`CREATE TABLE public.idp_data_import_jobs (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	last_run_time TIMESTAMP NOT NULL,
	import_type VARCHAR NOT NULL,
	status VARCHAR NOT NULL,
	error VARCHAR NOT NULL,
	s3_bucket VARCHAR NOT NULL,
	object_key VARCHAR NOT NULL,
	expiration_minutes INT8 NOT NULL,
	file_size INT8 NOT NULL,
	processed_size INT8 NOT NULL,
	processed_record_count INT8 NOT NULL,
	failed_record_count INT8 NOT NULL,
	failed_records JSONB NOT NULL,
	CONSTRAINT idp_data_import_jobs_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.idp_sync_records (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	sync_run_id UUID NOT NULL,
	user_id VARCHAR NOT NULL,
	error VARCHAR NOT NULL,
	object_id VARCHAR NOT NULL DEFAULT '',
	warning VARCHAR NOT NULL DEFAULT '',
	CONSTRAINT idp_sync_records_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.idp_sync_runs (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	active_provider_id UUID NOT NULL,
	follower_provider_ids UUID[] NOT NULL DEFAULT ARRAY[]::uuid[],
	since TIMESTAMP NOT NULL,
	until TIMESTAMP NOT NULL,
	error VARCHAR NOT NULL,
	total_records INT8 NOT NULL DEFAULT 0,
	failed_records INT8 NOT NULL DEFAULT 0,
	type VARCHAR NOT NULL DEFAULT '',
	warning_records INT8 NOT NULL DEFAULT 0,
	CONSTRAINT idp_sync_runs_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE INDEX idp_sync_runs_active_provider_id_deleted_idx ON idp_sync_runs (active_provider_id, deleted)`,
	`CREATE TABLE public.mfa_requests (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	user_id UUID NOT NULL,
	issued TIMESTAMP NOT NULL,
	code VARCHAR NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	channel_id UUID NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000',
	supported_channel_types JSONB NOT NULL DEFAULT '{}',
	CONSTRAINT mfa_requests_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.mfa_states (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	session_id UUID NOT NULL,
	token VARCHAR NOT NULL,
	provider UUID NOT NULL,
	supported_channels JSONB NOT NULL DEFAULT '{}',
	channel_id UUID NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000',
	purpose INT8 NOT NULL DEFAULT 0,
	challenge_state INT8 NOT NULL DEFAULT 0,
	evaluate_supported_channels BOOL NOT NULL DEFAULT false,
	CONSTRAINT mfa_states_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.mutators (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	name VARCHAR NOT NULL,
	description VARCHAR NOT NULL,
	version INT8 NOT NULL,
	access_policy_id UUID NOT NULL,
	selector_config JSONB NOT NULL DEFAULT '{}',
	column_ids UUID[] NOT NULL DEFAULT ARRAY[]::uuid[],
	validator_ids UUID[] NOT NULL DEFAULT ARRAY[]::uuid[],
	is_system BOOL NOT NULL DEFAULT false,
	CONSTRAINT mutators_pkey PRIMARY KEY (deleted, id, version),
	UNIQUE (name, version, deleted)
)`,
	`CREATE TABLE public.object_types (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	type_name VARCHAR NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	CONSTRAINT object_types_pkey PRIMARY KEY (deleted, id),
	UNIQUE (type_name, deleted)
)`,
	`CREATE TABLE public.objects (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	alias VARCHAR NULL,
	type_id UUID NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	organization_id UUID NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000',
	CONSTRAINT objects_pkey PRIMARY KEY (deleted, id),
	UNIQUE (alias, type_id, organization_id, deleted)
)`,
	`CREATE TABLE public.oidc_login_sessions (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	client_id VARCHAR NOT NULL,
	response_types VARCHAR NOT NULL,
	redirect_uri VARCHAR NOT NULL,
	state VARCHAR NOT NULL,
	scopes VARCHAR NOT NULL,
	nonce VARCHAR NOT NULL,
	social_provider INT8 NOT NULL,
	mfa_state_id UUID NOT NULL,
	otp_state_id UUID NOT NULL,
	pkce_state_id UUID NOT NULL,
	delegation_state_id UUID NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000',
	add_authn_provider_data JSONB NOT NULL DEFAULT '{}',
	plex_token_id UUID NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000',
	mfa_channel_states JSONB NOT NULL DEFAULT '{}',
	oidc_issuer_url VARCHAR NOT NULL DEFAULT '',
	CONSTRAINT oidc_login_sessions_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.organizations (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	name VARCHAR NOT NULL,
	region VARCHAR NOT NULL DEFAULT '',
	CONSTRAINT organizations_pkey PRIMARY KEY (deleted, id),
	UNIQUE (deleted, name)
)`,
	`CREATE TABLE public.otp_states (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	session_id UUID NOT NULL,
	email VARCHAR NOT NULL,
	code VARCHAR NOT NULL,
	expires TIMESTAMP NOT NULL,
	used BOOL NOT NULL,
	purpose INT8 NOT NULL,
	user_id VARCHAR NOT NULL DEFAULT '',
	CONSTRAINT otp_states_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.pkce_states (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	session_id UUID NOT NULL,
	code_challenge VARCHAR NOT NULL,
	method INT8 NOT NULL,
	used BOOL NOT NULL,
	CONSTRAINT pkce_states_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.plex_config (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	plex_config JSONB NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	_version INT8 NOT NULL DEFAULT 0,
	CONSTRAINT plex_config_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.plex_tokens (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	client_id VARCHAR NOT NULL,
	auth_code VARCHAR NOT NULL,
	access_token VARCHAR NOT NULL,
	id_token VARCHAR NOT NULL,
	idp_subject VARCHAR NOT NULL,
	scopes VARCHAR NOT NULL,
	session_id UUID NOT NULL,
	underlying_token VARCHAR NOT NULL DEFAULT '',
	refresh_token VARCHAR NOT NULL DEFAULT '',
	CONSTRAINT plex_tokens_pkey PRIMARY KEY (deleted, id),
	UNIQUE (auth_code),
	UNIQUE (access_token)
)`,
	`CREATE TABLE public.purposes (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	name VARCHAR NOT NULL,
	description VARCHAR NOT NULL,
	is_system BOOL NOT NULL DEFAULT false,
	CONSTRAINT purposes_pkey PRIMARY KEY (deleted, id),
	UNIQUE (deleted, name)
)`,
	`CREATE TABLE public.saml_sessions (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	expire_time TIMESTAMP NOT NULL,
	_index VARCHAR NOT NULL,
	name_id VARCHAR NOT NULL,
	name_id_format VARCHAR NOT NULL,
	subject_id VARCHAR NOT NULL,
	groups JSONB NOT NULL DEFAULT '[]',
	user_name VARCHAR NOT NULL,
	user_email VARCHAR NOT NULL,
	user_common_name VARCHAR NOT NULL,
	user_surname VARCHAR NOT NULL,
	user_given_name VARCHAR NOT NULL,
	user_scoped_affiliation VARCHAR NOT NULL,
	custom_attributes JSONB NOT NULL DEFAULT '[]',
	state VARCHAR NOT NULL,
	relay_state VARCHAR NOT NULL,
	request_buffer BYTEA NOT NULL,
	CONSTRAINT saml_sessions_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.sqlshim_databases (
	id UUID NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL DEFAULT now(),
	name VARCHAR NOT NULL,
	type VARCHAR NOT NULL,
	host VARCHAR NOT NULL,
	port INT8 NOT NULL,
	username VARCHAR NOT NULL,
	password VARCHAR NOT NULL,
	schemas_updated TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	schemas_update_scheduled TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	schemas VARCHAR[] NOT NULL DEFAULT ARRAY[]::VARCHAR[],
	CONSTRAINT sqlshim_databases_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.token_records (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	transformer_id UUID NOT NULL,
	access_policy_id UUID NOT NULL,
	token VARCHAR NOT NULL,
	data VARCHAR NOT NULL,
	user_id UUID NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000',
	column_id UUID NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000',
	CONSTRAINT token_records_pkey PRIMARY KEY (deleted, token),
	UNIQUE (token, deleted),
	UNIQUE (id, deleted)
)`,
	`CREATE TABLE public.transformers (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	name VARCHAR NOT NULL,
	description VARCHAR NOT NULL,
	input_type INT8 NOT NULL,
	transform_type INT8 NOT NULL,
	function VARCHAR NOT NULL,
	parameters VARCHAR NOT NULL,
	tag_ids UUID[] NULL,
	is_system BOOL NOT NULL DEFAULT false,
	output_type INT8 NOT NULL,
	reuse_existing_token BOOL NULL DEFAULT true,
	input_type_constraints JSONB NOT NULL DEFAULT '{}',
	output_type_constraints JSONB NOT NULL DEFAULT '{}',
	input_data_type_id UUID NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000',
	output_data_type_id UUID NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000',
	CONSTRAINT transformers_pkey PRIMARY KEY (deleted, id),
	UNIQUE (deleted, name),
	UNIQUE (deleted, function, input_type, output_type, parameters, reuse_existing_token, transform_type)
)`,
	`CREATE TABLE public.user_cleanup_candidates (
	id UUID NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL DEFAULT now(),
	user_id UUID NOT NULL,
	cleanup_reason INT8 NOT NULL,
	CONSTRAINT user_cleanup_candidates_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.user_column_post_delete_values (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	_version INT8 NOT NULL,
	column_id UUID NOT NULL,
	user_id UUID NOT NULL,
	varchar_value VARCHAR NULL,
	boolean_value BOOL NULL,
	int_value INT8 NULL,
	timestamp_value TIMESTAMP NULL,
	uuid_value UUID NULL,
	jsonb_value JSONB NULL,
	ordering INT8 NOT NULL,
	consented_purpose_ids UUID[] NOT NULL,
	retention_timeouts VARCHAR[] NOT NULL,
	CONSTRAINT user_column_post_delete_values_pk PRIMARY KEY (id)
)`,
	`CREATE INDEX user_column_post_delete_values_varchar ON user_column_post_delete_values (column_id, user_id, varchar_value)`,
	`CREATE INDEX user_column_post_delete_values_boolean ON user_column_post_delete_values (column_id, user_id, boolean_value)`,
	`CREATE INDEX user_column_post_delete_values_int ON user_column_post_delete_values (column_id, user_id, int_value)`,
	`CREATE INDEX user_column_post_delete_values_timestamp ON user_column_post_delete_values (column_id, user_id, timestamp_value)`,
	`CREATE INDEX user_column_post_delete_values_uuid ON user_column_post_delete_values (column_id, user_id, uuid_value)`,
	`CREATE INDEX user_column_post_delete_values_jsonb ON user_column_post_delete_values USING gin(column_id, user_id, jsonb_value)`,
	`CREATE INDEX user_column_post_delete_values_user_id_idx ON user_column_post_delete_values (user_id)`,
	`CREATE TABLE public.user_column_pre_delete_values (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	_version INT8 NOT NULL,
	column_id UUID NOT NULL,
	user_id UUID NOT NULL,
	varchar_value VARCHAR NULL,
	varchar_unique_value VARCHAR NULL,
	boolean_value BOOL NULL,
	int_value INT8 NULL,
	int_unique_value INT8 NULL,
	timestamp_value TIMESTAMP NULL,
	uuid_value UUID NULL,
	uuid_unique_value UUID NULL,
	jsonb_value JSONB NULL,
	ordering INT8 NOT NULL,
	consented_purpose_ids UUID[] NOT NULL,
	retention_timeouts VARCHAR[] NOT NULL,
	CONSTRAINT user_column_pre_delete_values_pk PRIMARY KEY (id),
	UNIQUE (column_id, varchar_unique_value),
	UNIQUE (column_id, int_unique_value),
	UNIQUE (column_id, uuid_unique_value)
)`,
	`CREATE INDEX user_column_pre_delete_values_column_user_varchar ON user_column_pre_delete_values (column_id, user_id, varchar_value)`,
	`CREATE INDEX user_column_pre_delete_values_column_user_unique_varchar ON user_column_pre_delete_values (column_id, user_id, varchar_unique_value)`,
	`CREATE INDEX user_column_pre_delete_values_column_user_boolean ON user_column_pre_delete_values (column_id, user_id, boolean_value)`,
	`CREATE INDEX user_column_pre_delete_values_column_user_int ON user_column_pre_delete_values (column_id, user_id, int_value)`,
	`CREATE INDEX user_column_pre_delete_values_column_user_unique_int ON user_column_pre_delete_values (column_id, user_id, int_unique_value)`,
	`CREATE INDEX user_column_pre_delete_values_column_user_timestamp ON user_column_pre_delete_values (column_id, user_id, timestamp_value)`,
	`CREATE INDEX user_column_pre_delete_values_column_user_uuid ON user_column_pre_delete_values (column_id, user_id, uuid_value)`,
	`CREATE INDEX user_column_pre_delete_values_column_user_unique_uuid ON user_column_pre_delete_values (column_id, user_id, uuid_unique_value)`,
	`CREATE INDEX user_column_pre_delete_values_column_user_jsonb ON user_column_pre_delete_values USING gin(column_id, user_id, jsonb_value)`,
	`CREATE INDEX user_column_pre_delete_values_user_id_idx ON user_column_pre_delete_values (user_id)`,
	`CREATE TABLE public.user_mfa_configuration (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	last_evaluated TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	mfa_channels JSONB NOT NULL DEFAULT '{}',
	CONSTRAINT user_mfa_configuration_pkey PRIMARY KEY (deleted, id)
)`,
	`CREATE TABLE public.users (
	id UUID NOT NULL,
	created TIMESTAMP NOT NULL DEFAULT now(),
	updated TIMESTAMP NOT NULL,
	deleted TIMESTAMP NOT NULL DEFAULT '0001-01-01 00:00:00',
	organization_id UUID NOT NULL DEFAULT '00000000-0000-0000-0000-000000000000',
	_version INT8 NOT NULL DEFAULT 0,
	region VARCHAR NOT NULL DEFAULT '',
	CONSTRAINT users_pkey PRIMARY KEY (deleted, id)
)`,
}
